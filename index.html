<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Mockup Prompt Generator</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #fafafa;
            color: #1a1a1a;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 48px 24px;
        }

        header {
            margin-bottom: 48px;
        }

        h1 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            color: #666;
            font-size: 15px;
        }

        .task-badge {
            display: inline-block;
            background: #1a1a1a;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 16px;
        }

        .instructions {
            background: #f0f0f0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 32px;
        }

        .instructions h3 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #333;
        }

        .instructions ol {
            padding-left: 20px;
            font-size: 14px;
            color: #555;
        }

        .instructions li {
            margin-bottom: 8px;
        }

        .input-section {
            margin-bottom: 40px;
        }

        .input-group {
            margin-bottom: 24px;
        }

        label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .label-hint {
            font-weight: 400;
            color: #888;
            margin-left: 8px;
        }

        input[type="text"], textarea, select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e5e5e5;
            border-radius: 10px;
            font-size: 15px;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
            background: white;
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 18px;
            padding-right: 44px;
        }

        input[type="text"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #1a1a1a;
            box-shadow: 0 0 0 3px rgba(26, 26, 26, 0.1);
        }

        input[type="text"]::placeholder, textarea::placeholder {
            color: #aaa;
        }

        .image-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        .image-card {
            background: white;
            border: 2px solid #e5e5e5;
            border-radius: 12px;
            overflow: hidden;
        }

        .image-card.full-width {
            grid-column: 1 / -1;
        }

        .image-card-header {
            padding: 12px 16px;
            background: #fafafa;
            border-bottom: 1px solid #e5e5e5;
        }

        .image-card-header h4 {
            font-size: 13px;
            font-weight: 600;
            color: #333;
        }

        .image-card-header span {
            font-size: 12px;
            color: #888;
            font-weight: 400;
        }

        .image-preview {
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 200px;
            background: #f8f8f8;
        }

        .image-preview img {
            max-width: 100%;
            max-height: 250px;
            object-fit: contain;
            border-radius: 8px;
        }

        .output-section {
            background: white;
            border: 2px solid #e5e5e5;
            border-radius: 12px;
            overflow: hidden;
        }

        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid #e5e5e5;
            background: #fafafa;
        }

        .output-header h2 {
            font-size: 14px;
            font-weight: 600;
        }

        .copy-btn, .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            background: #1a1a1a;
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
        }

        .copy-btn:hover, .btn:hover {
            background: #333;
        }

        .copy-btn:active, .btn:active {
            transform: scale(0.98);
        }

        .copy-btn.copied {
            background: #22c55e;
        }

        .copy-btn svg, .btn svg {
            width: 16px;
            height: 16px;
        }

        .btn-secondary {
            background: white;
            color: #1a1a1a;
            border: 2px solid #e5e5e5;
        }

        .btn-secondary:hover {
            background: #f5f5f5;
        }

        .btn-danger {
            background: #ef4444;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .output-content {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        #promptOutput {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-size: 12px;
            line-height: 1.7;
            white-space: pre-wrap;
            color: #333;
        }

        footer {
            margin-top: 48px;
            padding-top: 24px;
            border-top: 1px solid #e5e5e5;
            text-align: center;
            color: #888;
            font-size: 13px;
        }

        .color-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
            border: 1px solid rgba(0,0,0,0.1);
        }

        .input-with-hint {
            position: relative;
        }

        .explainer-hint {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            padding: 10px 14px;
            background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);
            border-radius: 8px;
            border-left: 3px solid #a855f7;
        }

        .hand-pointer {
            font-size: 20px;
            animation: point 1s ease-in-out infinite;
        }

        @keyframes point {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-4px); }
        }

        .hint-text {
            font-size: 13px;
            color: #6b21a8;
            font-weight: 500;
        }

        .readonly-input {
            background: #f5f5f5 !important;
            color: #666 !important;
            cursor: not-allowed;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 32px;
            border-bottom: 2px solid #e5e5e5;
            padding-bottom: 0;
        }

        .tab {
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            background: none;
            border: none;
            cursor: pointer;
            position: relative;
            transition: color 0.2s;
        }

        .tab:hover {
            color: #333;
        }

        .tab.active {
            color: #1a1a1a;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #1a1a1a;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Design Gallery */
        .gallery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .gallery-header h2 {
            font-size: 18px;
            font-weight: 600;
        }

        .gallery-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }

        .sync-status {
            font-size: 12px;
            color: #888;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .sync-status.syncing {
            color: #a855f7;
        }

        .sync-status.error {
            color: #ef4444;
        }

        .upload-zone {
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: #fafafa;
            margin-bottom: 24px;
        }

        .upload-zone:hover {
            border-color: #a855f7;
            background: #faf5ff;
        }

        .upload-zone.dragover {
            border-color: #a855f7;
            background: #f3e8ff;
        }

        .upload-zone.uploading {
            pointer-events: none;
            opacity: 0.7;
        }

        .upload-zone-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .upload-zone-text {
            font-size: 15px;
            color: #666;
            margin-bottom: 4px;
        }

        .upload-zone-hint {
            font-size: 13px;
            color: #999;
        }

        .design-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
        }

        .design-item {
            background: white;
            border: 2px solid #e5e5e5;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.2s;
            cursor: pointer;
        }

        .design-item:hover {
            border-color: #a855f7;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .design-item-image {
            aspect-ratio: 1;
            background: #f8f8f8;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .design-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .design-item-info {
            padding: 12px;
        }

        .design-item-name {
            font-size: 13px;
            font-weight: 500;
            color: #333;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .design-item-date {
            font-size: 11px;
            color: #999;
        }

        .design-item-actions {
            display: flex;
            gap: 8px;
            padding: 0 12px 12px;
        }

        .design-item-actions button {
            flex: 1;
            padding: 8px;
            font-size: 12px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #888;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 15px;
            margin-bottom: 8px;
        }

        .empty-state-hint {
            font-size: 13px;
            color: #aaa;
        }

        .loading-state {
            text-align: center;
            padding: 60px 20px;
            color: #888;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #e5e5e5;
            border-top-color: #a855f7;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 16px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e5e5e5;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 16px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #888;
            line-height: 1;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-preview {
            width: 100%;
            aspect-ratio: 1;
            background: #f8f8f8;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            overflow: hidden;
        }

        .modal-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .modal-actions {
            display: flex;
            gap: 8px;
        }

        .modal-actions button {
            flex: 1;
        }

        @media (max-width: 600px) {
            .container {
                padding: 24px 16px;
            }

            h1 {
                font-size: 24px;
            }

            .image-grid {
                grid-template-columns: 1fr;
            }

            .output-header {
                flex-direction: column;
                gap: 12px;
                align-items: stretch;
            }

            .tabs {
                overflow-x: auto;
            }

            .gallery-header {
                flex-direction: column;
                align-items: stretch;
            }

            .gallery-actions {
                justify-content: stretch;
            }

            .gallery-actions button {
                flex: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <span class="task-badge">Task 1</span>
            <h1>Embossed Notebook Design Generator</h1>
            <p class="subtitle">Generate prompts for creating embossed notebook designs in ChatGPT</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('generator')">Prompt Generator</button>
            <button class="tab" onclick="switchTab('designs')">Design Library</button>
        </div>

        <!-- Generator Tab -->
        <div id="generator-tab" class="tab-content active">
            <div class="instructions">
                <h3>How to use</h3>
                <ol>
                    <li>Select a base notebook color from the dropdown</li>
                    <li>Describe your design artwork (Image B)</li>
                    <li>Upload the 3 images shown below into ChatGPT</li>
                    <li>Copy the generated prompt and paste it into ChatGPT</li>
                </ol>
            </div>

            <div class="input-section">
                <div class="input-group">
                    <label>
                        Image A ‚Äî Base Notebook Color
                    </label>
                    <select id="notebookColor" onchange="updateImages()">
                        <option value="blue">Blue</option>
                        <option value="grey">Grey</option>
                        <option value="pink">Pink</option>
                        <option value="purple">Purple</option>
                    </select>
                </div>

                <div class="input-group image-b-group">
                    <label>
                        Image B ‚Äî Design Description
                    </label>
                    <div class="input-with-hint">
                        <input
                            type="text"
                            id="imageB"
                            placeholder="e.g., watercolour art, geometric pattern, floral illustration"
                            value="watercolour art"
                        >
                        <div class="explainer-hint">
                            <span class="hand-pointer">üëÜ</span>
                            <span class="hint-text">Describe the design you're uploading to mockup</span>
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label>
                        Image C ‚Äî Embossing Reference
                        <span class="label-hint">(fixed)</span>
                    </label>
                    <input
                        type="text"
                        id="imageC"
                        value="A blue PU notebook with an embossed dog design"
                        readonly
                        class="readonly-input"
                    >
                </div>
            </div>

            <h3 style="font-size: 14px; margin-bottom: 16px; color: #333;">Images to upload to ChatGPT <span style="font-weight: 400; color: #999;">(you can copy & paste directly)</span></h3>

            <div class="image-grid">
                <div class="image-card">
                    <div class="image-card-header">
                        <h4>Image A ‚Äî Base Notebook</h4>
                        <span id="imageALabel">blue.png</span>
                    </div>
                    <div class="image-preview">
                        <img id="imageAPreview" src="Template Images for Product Listing/blue.png" alt="Base notebook">
                    </div>
                </div>

                <div class="image-card">
                    <div class="image-card-header">
                        <h4>Image C ‚Äî Embossing Reference</h4>
                        <span>bluedog.png</span>
                    </div>
                    <div class="image-preview">
                        <img src="Template Images for Product Listing/bluedog.png" alt="Embossing reference">
                    </div>
                </div>

                <div class="image-card full-width">
                    <div class="image-card-header">
                        <h4>Image B ‚Äî Your Design</h4>
                        <span>Upload your own artwork or select from Design Library</span>
                    </div>
                    <div class="image-preview" id="imageBPreview" style="min-height: 100px; color: #888; font-size: 14px;">
                        <span id="imageBPlaceholder">Upload your design artwork to ChatGPT</span>
                        <img id="imageBSelected" style="display: none;" alt="Selected design">
                    </div>
                </div>
            </div>

            <div class="output-section">
                <div class="output-header">
                    <h2>Generated Prompt</h2>
                    <button class="copy-btn" onclick="copyPrompt()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                        <span id="copyText">Copy Prompt</span>
                    </button>
                </div>
                <div class="output-content">
                    <div id="promptOutput"></div>
                </div>
            </div>
        </div>

        <!-- Design Library Tab -->
        <div id="designs-tab" class="tab-content">
            <div class="gallery-header">
                <h2>Design Library</h2>
                <div class="gallery-actions">
                    <span id="syncStatus" class="sync-status">
                        <span>‚òÅÔ∏è</span> Synced
                    </span>
                    <button class="btn btn-secondary" onclick="loadDesigns()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                            <path d="M23 4v6h-6"></path>
                            <path d="M1 20v-6h6"></path>
                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                        </svg>
                        Refresh
                    </button>
                </div>
            </div>

            <div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()">
                <div class="upload-zone-icon">üìÅ</div>
                <div class="upload-zone-text" id="uploadText">Drop your design images here or click to upload</div>
                <div class="upload-zone-hint">Supports PNG, JPG, WEBP ‚Ä¢ Shared with all designers</div>
                <input type="file" id="fileInput" accept="image/*" multiple style="display: none;" onchange="handleFileUpload(event)">
            </div>

            <div id="loadingState" class="loading-state" style="display: none;">
                <div class="loading-spinner"></div>
                <div>Loading designs...</div>
            </div>

            <div id="designGrid" class="design-grid">
                <!-- Designs will be populated here -->
            </div>

            <div id="emptyState" class="empty-state" style="display: none;">
                <div class="empty-state-icon">üé®</div>
                <div class="empty-state-text">No designs uploaded yet</div>
                <div class="empty-state-hint">Upload your first design to get started</div>
            </div>
        </div>

        <footer>
            Product Mockup Prompt Generator
        </footer>
    </div>

    <!-- Preview Modal -->
    <div class="modal-overlay" id="previewModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle">Design Preview</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-preview">
                    <img id="modalImage" src="" alt="Design preview">
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="useDesign()">Use in Generator</button>
                    <button class="btn btn-danger" id="deleteBtn" onclick="deleteDesign()">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://jyosixwjbsahcctyakdi.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_S5JGtvltlC1Q314L50QR4A_zYvzDjCR';
        const BUCKET_NAME = 'designs';

        // Initialize Supabase client
        const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Design storage
        let designs = [];
        let currentDesign = null;

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

            document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
            document.getElementById(`${tab}-tab`).classList.add('active');

            if (tab === 'designs') {
                loadDesigns();
            }
        }

        // Color descriptions
        const colorDescriptions = {
            blue: 'A PLAIN blue PU-leather notebook',
            grey: 'A PLAIN grey PU-leather notebook',
            pink: 'A PLAIN pink PU-leather notebook',
            purple: 'A PLAIN purple PU-leather notebook'
        };

        function updateImages() {
            const color = document.getElementById('notebookColor').value;
            document.getElementById('imageAPreview').src = `Template Images for Product Listing/${color}.png`;
            document.getElementById('imageALabel').textContent = `${color}.png`;
            generatePrompt();
        }

        function generatePrompt() {
            const color = document.getElementById('notebookColor').value;
            const imageA = colorDescriptions[color];
            const imageB = document.getElementById('imageB').value || '[Describe Image B]';
            const imageC = 'A blue PU notebook with an embossed dog design';

            const prompt = `Create the image using the instructions below. Do not use python.

IMAGE A ‚Äî BASE NOTEBOOK (EDIT THIS IMAGE)
Describe Image A in one sentence:
${imageA}

IMAGE B ‚Äî DESIGN SOURCE (ARTWORK ONLY)
Describe Image B in one sentence:
${imageB}

IMAGE C ‚Äî EMBOSSING & LIGHTING REFERENCE (REFERENCE ONLY)
Describe Image C in one sentence:
${imageC}

HOW EACH IMAGE MAY BE USED

IMAGE A (Base Notebook)
This image defines and must retain:
‚Ä¢ notebook shape, size, thickness, proportions
‚Ä¢ camera angle, perspective, framing
‚Ä¢ lighting direction and shadows
‚Ä¢ background and props
‚Ä¢ surface material and texture (smooth PU leather)

‚ö†Ô∏è Image A must remain visually identical except for:
‚Ä¢ the design that gets translated onto the cover

IMAGE B (Design Source)
Use only:
‚Ä¢ the artwork
‚Ä¢ the colour palette for the notebook cover

‚ùå Do NOT copy from Image B:
‚Ä¢ lighting
‚Ä¢ texture
‚Ä¢ background
‚Ä¢ composition
‚Ä¢ notebook geometry or notebook size or notebook features or stitching or any other effects

IMAGE C (Reference Only)
Image C exists ONLY to teach:
‚Ä¢ how strong embossing should look in photography
‚Ä¢ how lighting reveals raised texture
‚Ä¢ how shadows and highlights prove depth

‚ùå NEVER copy from Image C:
‚Ä¢ any artwork or motif
‚Ä¢ any colours
‚Ä¢ any layout or composition
‚Ä¢ any props or objects

If any design cue from Image C appears in the output, the result is INVALID.

CORE TASK
Edit IMAGE A so that:
‚Ä¢ The notebook cover colour matches the colour from IMAGE B
‚Ä¢ The artwork from IMAGE B is applied to the notebook cover
‚Ä¢ The artwork appears as a REAL, MANUFACTURED, UV-EMBOSSED / TESSELLATED PRINT
‚Ä¢ The notebook surface remains smooth everywhere except the embossed design

This is a photorealistic image edit, not a new generation.

NON-NEGOTIABLE EMBOSSING RULES
‚Ä¢ This is NOT flat printing.
‚Ä¢ You MUST exaggerate embossing depth so it is clearly visible in photos
‚Ä¢ Embossing must read as ~4‚Äì6mm at normal viewing distance
‚Ä¢ Embossing must be obvious without zooming
‚Ä¢ If embossing is subtle, the result is WRONG

HEIGHT VARIATION IS REQUIRED
‚Ä¢ Primary edges / outer silhouette ‚Üí highest relief
‚Ä¢ Major internal forms ‚Üí medium relief
‚Ä¢ Minor details ‚Üí shallow relief
‚Ä¢ Background leather ‚Üí zero relief

The design must appear PRESSED INTO the leather via pressure and UV curing ‚Äî not painted or stuck on top.

EDGE & SHADOW BEHAVIOUR (PROOF OF EMBOSS)
To prove embossing, you MUST show:
‚Ä¢ Clear contact shadows where raised ink meets flat leather
‚Ä¢ Shadow falloff on the down-light side of raised edges
‚Ä¢ Bright highlight bands on the light-facing edges
‚Ä¢ Micro self-shadowing between overlapping raised forms
‚Ä¢ Soft, rounded, organically pressed edges (no sharp cutouts)

If there are no visible shadows hugging the artwork edges, embossing is not convincing.

LEATHER INTERACTION (REALISM)
‚Ä¢ PU leather grain must continue seamlessly through embossed areas
‚Ä¢ Grain compresses slightly near raised edges
‚Ä¢ Base leather stays smooth everywhere except the design

‚ùå No stickers
‚ùå No decals
‚ùå No floating layers
‚ùå No white outlines

LIGHTING (DO NOT IGNORE)
Use strong raking light similar to Image C:
‚Ä¢ Catch raised edges with specular highlights
‚Ä¢ Cast visible micro-shadows across the surface
‚Ä¢ Increase local contrast around embossed regions
‚Ä¢ Make depth obvious even at thumbnail size

Flat lighting = failure.

POSITION & GEOMETRY (LOCKED)
‚Ä¢ Keep notebook geometry, camera angle, perspective, and placement identical to Image A
‚Ä¢ Do NOT change notebook thickness, edges, spine, ribbons, or page block
‚Ä¢ Apply the design in a natural, premium placement on the cover
‚Ä¢ Do NOT move, rotate, or resize the design arbitrarily

RENDERING CONSTRAINTS
‚Ä¢ Photorealistic product photography (not illustration)
‚Ä¢ No painterly textures
‚Ä¢ No canvas or paper grain
‚Ä¢ No CAD bevels or uniform extrusion

FINAL SELF-VALIDATION (MANDATORY)
Before outputting, ask yourself:
‚Ä¢ Does the notebook still look exactly like Image A?
‚Ä¢ Is the artwork ONLY from Image B?
‚Ä¢ Does the embossing read clearly at normal viewing distance?
‚Ä¢ Would a customer believe they could feel this with their fingertips?

If any answer is "no", fix it before outputting.
If not, increase embossing depth, edge highlights, and contact shadows until it passes.

Ensure the output is a high quality 4k resolution image with absolutely no fuzziness or grain.`;

            document.getElementById('promptOutput').textContent = prompt;
        }

        function copyPrompt() {
            const promptText = document.getElementById('promptOutput').textContent;
            navigator.clipboard.writeText(promptText).then(() => {
                const btn = document.querySelector('.copy-btn');
                const copyText = document.getElementById('copyText');
                btn.classList.add('copied');
                copyText.textContent = 'Copied!';

                setTimeout(() => {
                    btn.classList.remove('copied');
                    copyText.textContent = 'Copy Prompt';
                }, 2000);
            });
        }

        // Supabase Design Library Functions
        function setSyncStatus(status, message) {
            const statusEl = document.getElementById('syncStatus');
            statusEl.className = 'sync-status ' + status;
            if (status === 'syncing') {
                statusEl.innerHTML = '<span>üîÑ</span> ' + message;
            } else if (status === 'error') {
                statusEl.innerHTML = '<span>‚ö†Ô∏è</span> ' + message;
            } else {
                statusEl.innerHTML = '<span>‚òÅÔ∏è</span> ' + message;
            }
        }

        async function loadDesigns() {
            const grid = document.getElementById('designGrid');
            const emptyState = document.getElementById('emptyState');
            const loadingState = document.getElementById('loadingState');

            loadingState.style.display = 'block';
            grid.style.display = 'none';
            emptyState.style.display = 'none';
            setSyncStatus('syncing', 'Loading...');

            try {
                const { data, error } = await supabaseClient.storage
                    .from(BUCKET_NAME)
                    .list('', {
                        limit: 100,
                        sortBy: { column: 'created_at', order: 'desc' }
                    });

                if (error) throw error;

                designs = data.filter(file => !file.id.endsWith('/')).map(file => ({
                    name: file.name,
                    url: `${SUPABASE_URL}/storage/v1/object/public/${BUCKET_NAME}/${file.name}`,
                    created_at: file.created_at
                }));

                renderDesigns();
                setSyncStatus('', 'Synced');
            } catch (error) {
                console.error('Error loading designs:', error);
                setSyncStatus('error', 'Failed to load');
            } finally {
                loadingState.style.display = 'none';
            }
        }

        function renderDesigns() {
            const grid = document.getElementById('designGrid');
            const emptyState = document.getElementById('emptyState');

            if (designs.length === 0) {
                grid.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }

            grid.style.display = 'grid';
            emptyState.style.display = 'none';

            grid.innerHTML = designs.map(design => `
                <div class="design-item" onclick="openPreview('${design.name}')">
                    <div class="design-item-image">
                        <img src="${design.url}" alt="${design.name}" loading="lazy">
                    </div>
                    <div class="design-item-info">
                        <div class="design-item-name">${design.name}</div>
                        <div class="design-item-date">${design.created_at ? new Date(design.created_at).toLocaleDateString() : 'Recently added'}</div>
                    </div>
                </div>
            `).join('');
        }

        async function handleFileUpload(event) {
            const files = event.target.files;
            if (!files.length) return;

            const uploadZone = document.getElementById('uploadZone');
            const uploadText = document.getElementById('uploadText');

            uploadZone.classList.add('uploading');
            uploadText.textContent = 'Uploading...';
            setSyncStatus('syncing', 'Uploading...');

            try {
                for (const file of files) {
                    if (!file.type.startsWith('image/')) continue;

                    // Create unique filename
                    const timestamp = Date.now();
                    const safeName = file.name.replace(/[^a-zA-Z0-9.-]/g, '_');
                    const fileName = `${timestamp}_${safeName}`;

                    const { error } = await supabaseClient.storage
                        .from(BUCKET_NAME)
                        .upload(fileName, file, {
                            cacheControl: '3600',
                            upsert: false
                        });

                    if (error) throw error;
                }

                await loadDesigns();
                setSyncStatus('', 'Synced');
            } catch (error) {
                console.error('Error uploading:', error);
                setSyncStatus('error', 'Upload failed');
                alert('Upload failed: ' + error.message);
            } finally {
                uploadZone.classList.remove('uploading');
                uploadText.textContent = 'Drop your design images here or click to upload';
                event.target.value = '';
            }
        }

        function openPreview(name) {
            currentDesign = designs.find(d => d.name === name);
            if (currentDesign) {
                document.getElementById('modalTitle').textContent = currentDesign.name;
                document.getElementById('modalImage').src = currentDesign.url;
                document.getElementById('previewModal').classList.add('active');
            }
        }

        function closeModal() {
            document.getElementById('previewModal').classList.remove('active');
            currentDesign = null;
        }

        function useDesign() {
            if (currentDesign) {
                document.getElementById('imageBPlaceholder').style.display = 'none';
                document.getElementById('imageBSelected').src = currentDesign.url;
                document.getElementById('imageBSelected').style.display = 'block';
                closeModal();
                switchTab('generator');
            }
        }

        async function deleteDesign() {
            if (!currentDesign) return;

            if (!confirm('Are you sure you want to delete this design?')) return;

            const deleteBtn = document.getElementById('deleteBtn');
            deleteBtn.disabled = true;
            deleteBtn.textContent = 'Deleting...';

            try {
                const { error } = await supabaseClient.storage
                    .from(BUCKET_NAME)
                    .remove([currentDesign.name]);

                if (error) throw error;

                closeModal();
                await loadDesigns();
            } catch (error) {
                console.error('Error deleting:', error);
                alert('Delete failed: ' + error.message);
            } finally {
                deleteBtn.disabled = false;
                deleteBtn.textContent = 'Delete';
            }
        }

        // Drag and drop
        const uploadZone = document.getElementById('uploadZone');

        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        });

        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragover');
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            const files = e.dataTransfer.files;
            handleFileUpload({ target: { files } });
        });

        // Close modal on overlay click
        document.getElementById('previewModal').addEventListener('click', (e) => {
            if (e.target.id === 'previewModal') {
                closeModal();
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            generatePrompt();
        });

        document.getElementById('imageB').addEventListener('input', generatePrompt);
    </script>
</body>
</html>
